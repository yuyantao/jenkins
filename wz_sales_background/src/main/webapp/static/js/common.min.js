function ajax(obj){var type="post";if(typeof(obj.type)!="undefined"){type=obj.type}var data={};if(typeof(obj.data)!="undefined"){data=obj.data}var dataType="json";if(typeof(obj.dataType)!="undefined"){dataType=obj.dataType}$.ajax({type:type,url:obj.url,data:data,dataType:dataType,success:function(data){obj.success(data)},error:function(XMLHttpRequest,textStatus,errorThrown){console.log(XMLHttpRequest);console.log(textStatus);console.log(errorThrown);if(typeof(obj.error)=="function"){obj.error}else{if(XMLHttpRequest.readyState==4){if(XMLHttpRequest.responseText.indexOf("无权操作")>0){layer.msg("无权操作")}}else{layer.msg("网络请求失败，请稍后再试！")}}}})}function load(obj){var fragment="";if(typeof(obj.fragment)!="undefined"){fragment=obj.fragment}var data={};if(typeof(obj.data)!="undefined"){data=obj.data}$(obj.element).load(obj.url+""+fragment,data,function(response,status,xhr){if(response.indexOf("userNotLogin")>=0){location.reload();return}if(typeof(obj.success)=="function"){obj.success(response,status,xhr)}})}function loadPadding(paddingId){laypage({cont:paddingId,pages:$("#"+paddingId).html(),curr:$("#pageNum").html(),skin:"#c00",groups:8,jump:function(obj,first){if(!first){loadData(obj.curr)}}})}function pagingList(obj){var defaultTbodyId="listData";if(typeof(obj.divId)!="undefined"){defaultTbodyId=obj.tbodyId}var now=Date.now();var layerLoad=layer.load(0,{shade:0.1});load({element:"#"+defaultTbodyId,url:obj.url,fragment:" #"+defaultTbodyId+" tr",data:obj.data,success:function(response,status,xhr){if(typeof(obj.success)=="function"){obj.success()}else{if(typeof(obj.paddingId)!="undefined"){loadPadding(obj.paddingId)}var delayTime=300;var runningTime=new Date()-now;if(runningTime>delayTime){layer.close(layerLoad)}else{setTimeout(function(){layer.close(layerLoad)},(delayTime-runningTime))}}}})}var crud={del:function(obj){var title="是否确认删除!";if(typeof(obj.title)!="undefined"){title=obj.title}layer.confirm(title,{icon:3,btn:["确认","取消"]},function(index){ajax({url:obj.url,data:obj.data,success:function(data){if(data>0){layer.msg("数据操作成功",{offset:0,shift:6});if(typeof(obj.success)=="function"){obj.success()}}else{layer.msg("操作失败，请稍后再试！")}}})})},editPage:function(obj){layer.closeAll("dialog");layer.open({type:1,title:obj.title,btn:["确认","取消"],area:obj.area,shadeClose:true,success:function(layero,index){console.log($(".layui-layer-content"));load({element:".layui-layer-content",data:{id:obj.id},url:obj.editPageUrl,success:function(response,status,xhr){$(".layui-layer-content form").append("<a href='javascript:void(0);' class='btn_sub'></a>");$(".layui-layer-content form").Validform({tiptype:2,btnSubmit:".btn_sub",beforeSubmit:function(curform){ajax({url:obj.saveUrl,data:$(".layui-layer-content form").serialize(),dataType:"text",success:function(data){if("true"==data){layer.msg("操作成功！",{icon:6});layer.close(index);loadData(1)}else{layer.msg("操作失败，请稍后再试！",{icon:5})}}});return false}});if(typeof(obj.success)=="function"){obj.success()}}})},yes:function(index,layero){$(".btn_sub").click()}})}};